<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Exercise 1: Orange juice dataset | STATS5099 Data Mining and Machine Learning</title>
  <meta name="description" content="2 Exercise 1: Orange juice dataset | STATS5099 Data Mining and Machine Learning" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Exercise 1: Orange juice dataset | STATS5099 Data Mining and Machine Learning" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Exercise 1: Orange juice dataset | STATS5099 Data Mining and Machine Learning" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to DMML Lab 5</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#support-vector-machines"><i class="fa fa-check"></i><b>1.1</b> Support vector machines</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exercise-1-orange-juice-dataset.html"><a href="exercise-1-orange-juice-dataset.html"><i class="fa fa-check"></i><b>2</b> Exercise 1: Orange juice dataset</a>
<ul>
<li class="chapter" data-level="2.1" data-path="exercise-1-orange-juice-dataset.html"><a href="exercise-1-orange-juice-dataset.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="2.2" data-path="exercise-1-orange-juice-dataset.html"><a href="exercise-1-orange-juice-dataset.html#effect-of-different-parameters-in-svm"><i class="fa fa-check"></i><b>2.2</b> Effect of different parameters in SVM</a></li>
<li class="chapter" data-level="2.3" data-path="exercise-1-orange-juice-dataset.html"><a href="exercise-1-orange-juice-dataset.html#build-an-svm"><i class="fa fa-check"></i><b>2.3</b> Build an SVM</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STATS5099 Data Mining and Machine Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercise-1-orange-juice-dataset" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Exercise 1: Orange juice dataset<a href="exercise-1-orange-juice-dataset.html#exercise-1-orange-juice-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The <code>OJ</code> data from the <code>ISLR</code> package contains 1070 purchases where the customer either purchased Citrus Hill or Minute Maid Orange Juice. A number of characteristics of the customer and product are recorded.</p>
<ul>
<li><code>Purchase</code>: A factor with levels CH and MM indicating whether the customer purchased Citrus Hill or Minute Maid Orange Juice (i.e. response/class)</li>
<li><code>WeekofPurchase</code>: Week of purchase</li>
<li><code>StoreID</code>: Store ID</li>
<li><code>PriceCH</code>: Price charged for CH</li>
<li><code>PriceMM</code>: Price charged for MM</li>
<li><code>DiscCH</code>: Discount offered for CH</li>
<li><code>DiscMM</code>: Discount offered for MM</li>
<li><code>SpecialCH</code>: Indicator of special on CH</li>
<li><code>SpecialMM</code>: Indicator of special on MM</li>
<li><code>LoyalCH</code>: Customer brand loyalty for CH</li>
<li><code>SalePriceMM</code>:Sale price for MM</li>
<li><code>SalePriceCH</code>: Sale price for CH</li>
<li><code>PriceDiff</code>: Sale price of MM less sale price of CH</li>
<li><code>Store7</code>: A factor with levels No and Yes indicating whether the sale is at Store 7</li>
<li><code>PctDiscMM</code>: Percentage discount for MM</li>
<li><code>PctDiscCH</code>: Percentage discount for CH</li>
<li><code>ListPriceDiff</code>: List price of MM less list price of CH</li>
<li><code>STORE</code>: Which of 5 possible stores the sale occured at</li>
</ul>
<p>The question of interest is to predict which brand of orange juice a customer will purchase (<code>Purchase</code> variable).</p>
<p>Source: Stine, Robert A., Foster, Dean P., Waterman, Richard P. Business Analysis Using Regression (1998). Published by Springer.</p>
<p>To load the data, use</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="exercise-1-orange-juice-dataset.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb4-2"><a href="exercise-1-orange-juice-dataset.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(OJ)</span></code></pre></div>
<div id="exploratory-data-analysis" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Exploratory data analysis<a href="exercise-1-orange-juice-dataset.html#exploratory-data-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In <code>R</code>, categorical variables are sometimes recorded as numerical variables, which is inappropriate for subsequent analysis. To address this, <code>as.factor()</code> should be used to convert these variables back into categorical variables.</p>
<p><strong>Task</strong></p>
<ol style="list-style-type: decimal">
<li>Use <code>str</code>, <code>summary</code> and/or <code>skim</code> to inspect the data.</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Looking at the variable description above, is there any categorical variable encoded incorrectly as numerical variable? If so, correct them by using <code>as.factor()</code>.</li>
</ol>
<p>Excluding the response variable <code>Purchase</code>, how many variables are numerical variables and how many variables are categorical variables?</p>
<ul>
<li>The number of numerical variables = <input class='webex-solveme nospaces' size='2' data-answer='["12"]'/>.</li>
<li>The number of categorical variables = <input class='webex-solveme nospaces' size='1' data-answer='["5"]'/>.</li>
</ul>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="exercise-1-orange-juice-dataset.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb5-2"><a href="exercise-1-orange-juice-dataset.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(OJ)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1070 obs. of  18 variables:
##  $ Purchase      : Factor w/ 2 levels &quot;CH&quot;,&quot;MM&quot;: 1 1 1 2 1 1 1 1 1 1 ...
##  $ WeekofPurchase: num  237 239 245 227 228 230 232 234 235 238 ...
##  $ StoreID       : num  1 1 1 1 7 7 7 7 7 7 ...
##  $ PriceCH       : num  1.75 1.75 1.86 1.69 1.69 1.69 1.69 1.75 1.75 1.75 ...
##  $ PriceMM       : num  1.99 1.99 2.09 1.69 1.69 1.99 1.99 1.99 1.99 1.99 ...
##  $ DiscCH        : num  0 0 0.17 0 0 0 0 0 0 0 ...
##  $ DiscMM        : num  0 0.3 0 0 0 0 0.4 0.4 0.4 0.4 ...
##  $ SpecialCH     : num  0 0 0 0 0 0 1 1 0 0 ...
##  $ SpecialMM     : num  0 1 0 0 0 1 1 0 0 0 ...
##  $ LoyalCH       : num  0.5 0.6 0.68 0.4 0.957 ...
##  $ SalePriceMM   : num  1.99 1.69 2.09 1.69 1.69 1.99 1.59 1.59 1.59 1.59 ...
##  $ SalePriceCH   : num  1.75 1.75 1.69 1.69 1.69 1.69 1.69 1.75 1.75 1.75 ...
##  $ PriceDiff     : num  0.24 -0.06 0.4 0 0 0.3 -0.1 -0.16 -0.16 -0.16 ...
##  $ Store7        : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 1 1 1 2 2 2 2 2 2 ...
##  $ PctDiscMM     : num  0 0.151 0 0 0 ...
##  $ PctDiscCH     : num  0 0 0.0914 0 0 ...
##  $ ListPriceDiff : num  0.24 0.24 0.23 0 0 0.3 0.3 0.24 0.24 0.24 ...
##  $ STORE         : num  1 1 1 1 0 0 0 0 0 0 ...</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="exercise-1-orange-juice-dataset.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(OJ)</span></code></pre></div>
<table style="width: auto;" class="table table-condensed">
<caption>
<span id="tab:unnamed-chunk-8">Table 2.1: </span>Data summary
</caption>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
OJ
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
1070
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
18
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
16
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:left;">
ordered
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:left;">
top_counts
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Purchase
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
CH: 653, MM: 417
</td>
</tr>
<tr>
<td style="text-align:left;">
Store7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
No: 714, Yes: 356
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
WeekofPurchase
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
254.38
</td>
<td style="text-align:right;">
15.56
</td>
<td style="text-align:right;">
227.00
</td>
<td style="text-align:right;">
240.00
</td>
<td style="text-align:right;">
257.00
</td>
<td style="text-align:right;">
268.00
</td>
<td style="text-align:right;">
278.00
</td>
<td style="text-align:left;">
▆▅▅▇▇
</td>
</tr>
<tr>
<td style="text-align:left;">
StoreID
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.96
</td>
<td style="text-align:right;">
2.31
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:right;">
7.00
</td>
<td style="text-align:right;">
7.00
</td>
<td style="text-align:left;">
▇▅▃▁▇
</td>
</tr>
<tr>
<td style="text-align:left;">
PriceCH
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.87
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
1.69
</td>
<td style="text-align:right;">
1.79
</td>
<td style="text-align:right;">
1.86
</td>
<td style="text-align:right;">
1.99
</td>
<td style="text-align:right;">
2.09
</td>
<td style="text-align:left;">
▅▂▇▆▁
</td>
</tr>
<tr>
<td style="text-align:left;">
PriceMM
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.09
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
1.69
</td>
<td style="text-align:right;">
1.99
</td>
<td style="text-align:right;">
2.09
</td>
<td style="text-align:right;">
2.18
</td>
<td style="text-align:right;">
2.29
</td>
<td style="text-align:left;">
▂▁▃▇▆
</td>
</tr>
<tr>
<td style="text-align:left;">
DiscCH
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:left;">
▇▁▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
DiscMM
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:left;">
▇▁▂▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
SpecialCH
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
▇▁▁▁▂
</td>
</tr>
<tr>
<td style="text-align:left;">
SpecialMM
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.37
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
▇▁▁▁▂
</td>
</tr>
<tr>
<td style="text-align:left;">
LoyalCH
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
▅▃▆▆▇
</td>
</tr>
<tr>
<td style="text-align:left;">
SalePriceMM
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.96
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
1.19
</td>
<td style="text-align:right;">
1.69
</td>
<td style="text-align:right;">
2.09
</td>
<td style="text-align:right;">
2.13
</td>
<td style="text-align:right;">
2.29
</td>
<td style="text-align:left;">
▁▂▂▂▇
</td>
</tr>
<tr>
<td style="text-align:left;">
SalePriceCH
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.82
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
1.39
</td>
<td style="text-align:right;">
1.75
</td>
<td style="text-align:right;">
1.86
</td>
<td style="text-align:right;">
1.89
</td>
<td style="text-align:right;">
2.09
</td>
<td style="text-align:left;">
▂▁▇▇▅
</td>
</tr>
<tr>
<td style="text-align:left;">
PriceDiff
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
-0.67
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.64
</td>
<td style="text-align:left;">
▁▂▃▇▂
</td>
</tr>
<tr>
<td style="text-align:left;">
PctDiscMM
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:left;">
▇▁▂▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
PctDiscCH
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:left;">
▇▁▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
ListPriceDiff
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:left;">
▂▃▆▇▁
</td>
</tr>
<tr>
<td style="text-align:left;">
STORE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.63
</td>
<td style="text-align:right;">
1.43
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:left;">
▇▃▅▅▃
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="exercise-1-orange-juice-dataset.html#cb8-1" aria-hidden="true" tabindex="-1"></a>OJ<span class="sc">$</span>StoreID <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(OJ<span class="sc">$</span>StoreID)</span>
<span id="cb8-2"><a href="exercise-1-orange-juice-dataset.html#cb8-2" aria-hidden="true" tabindex="-1"></a>OJ<span class="sc">$</span>SpecialCH <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(OJ<span class="sc">$</span>SpecialCH)</span>
<span id="cb8-3"><a href="exercise-1-orange-juice-dataset.html#cb8-3" aria-hidden="true" tabindex="-1"></a>OJ<span class="sc">$</span>SpecialMM <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(OJ<span class="sc">$</span>SpecialMM)</span>
<span id="cb8-4"><a href="exercise-1-orange-juice-dataset.html#cb8-4" aria-hidden="true" tabindex="-1"></a>OJ<span class="sc">$</span>STORE <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(OJ<span class="sc">$</span>STORE)</span>
<span id="cb8-5"><a href="exercise-1-orange-juice-dataset.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(OJ)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1070 obs. of  18 variables:
##  $ Purchase      : Factor w/ 2 levels &quot;CH&quot;,&quot;MM&quot;: 1 1 1 2 1 1 1 1 1 1 ...
##  $ WeekofPurchase: num  237 239 245 227 228 230 232 234 235 238 ...
##  $ StoreID       : Factor w/ 5 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 1 5 5 5 5 5 5 ...
##  $ PriceCH       : num  1.75 1.75 1.86 1.69 1.69 1.69 1.69 1.75 1.75 1.75 ...
##  $ PriceMM       : num  1.99 1.99 2.09 1.69 1.69 1.99 1.99 1.99 1.99 1.99 ...
##  $ DiscCH        : num  0 0 0.17 0 0 0 0 0 0 0 ...
##  $ DiscMM        : num  0 0.3 0 0 0 0 0.4 0.4 0.4 0.4 ...
##  $ SpecialCH     : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 2 2 1 1 ...
##  $ SpecialMM     : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 2 1 1 1 2 2 1 1 1 ...
##  $ LoyalCH       : num  0.5 0.6 0.68 0.4 0.957 ...
##  $ SalePriceMM   : num  1.99 1.69 2.09 1.69 1.69 1.99 1.59 1.59 1.59 1.59 ...
##  $ SalePriceCH   : num  1.75 1.75 1.69 1.69 1.69 1.69 1.69 1.75 1.75 1.75 ...
##  $ PriceDiff     : num  0.24 -0.06 0.4 0 0 0.3 -0.1 -0.16 -0.16 -0.16 ...
##  $ Store7        : Factor w/ 2 levels &quot;No&quot;,&quot;Yes&quot;: 1 1 1 1 2 2 2 2 2 2 ...
##  $ PctDiscMM     : num  0 0.151 0 0 0 ...
##  $ PctDiscCH     : num  0 0 0.0914 0 0 ...
##  $ ListPriceDiff : num  0.24 0.24 0.23 0 0 0.3 0.3 0.24 0.24 0.24 ...
##  $ STORE         : Factor w/ 5 levels &quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,..: 2 2 2 2 1 1 1 1 1 1 ...</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="exercise-1-orange-juice-dataset.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(OJ)</span></code></pre></div>
<table style="width: auto;" class="table table-condensed">
<caption>
<span id="tab:unnamed-chunk-8">Table 2.1: </span>Data summary
</caption>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
OJ
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
1070
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
18
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:left;">
ordered
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:left;">
top_counts
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Purchase
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
CH: 653, MM: 417
</td>
</tr>
<tr>
<td style="text-align:left;">
StoreID
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
7: 356, 2: 222, 3: 196, 1: 157
</td>
</tr>
<tr>
<td style="text-align:left;">
SpecialCH
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
0: 912, 1: 158
</td>
</tr>
<tr>
<td style="text-align:left;">
SpecialMM
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
0: 897, 1: 173
</td>
</tr>
<tr>
<td style="text-align:left;">
Store7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
No: 714, Yes: 356
</td>
</tr>
<tr>
<td style="text-align:left;">
STORE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
0: 356, 2: 222, 3: 196, 1: 157
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
WeekofPurchase
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
254.38
</td>
<td style="text-align:right;">
15.56
</td>
<td style="text-align:right;">
227.00
</td>
<td style="text-align:right;">
240.00
</td>
<td style="text-align:right;">
257.00
</td>
<td style="text-align:right;">
268.00
</td>
<td style="text-align:right;">
278.00
</td>
<td style="text-align:left;">
▆▅▅▇▇
</td>
</tr>
<tr>
<td style="text-align:left;">
PriceCH
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.87
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
1.69
</td>
<td style="text-align:right;">
1.79
</td>
<td style="text-align:right;">
1.86
</td>
<td style="text-align:right;">
1.99
</td>
<td style="text-align:right;">
2.09
</td>
<td style="text-align:left;">
▅▂▇▆▁
</td>
</tr>
<tr>
<td style="text-align:left;">
PriceMM
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.09
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
1.69
</td>
<td style="text-align:right;">
1.99
</td>
<td style="text-align:right;">
2.09
</td>
<td style="text-align:right;">
2.18
</td>
<td style="text-align:right;">
2.29
</td>
<td style="text-align:left;">
▂▁▃▇▆
</td>
</tr>
<tr>
<td style="text-align:left;">
DiscCH
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:left;">
▇▁▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
DiscMM
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:left;">
▇▁▂▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
LoyalCH
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
▅▃▆▆▇
</td>
</tr>
<tr>
<td style="text-align:left;">
SalePriceMM
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.96
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
1.19
</td>
<td style="text-align:right;">
1.69
</td>
<td style="text-align:right;">
2.09
</td>
<td style="text-align:right;">
2.13
</td>
<td style="text-align:right;">
2.29
</td>
<td style="text-align:left;">
▁▂▂▂▇
</td>
</tr>
<tr>
<td style="text-align:left;">
SalePriceCH
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.82
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
1.39
</td>
<td style="text-align:right;">
1.75
</td>
<td style="text-align:right;">
1.86
</td>
<td style="text-align:right;">
1.89
</td>
<td style="text-align:right;">
2.09
</td>
<td style="text-align:left;">
▂▁▇▇▅
</td>
</tr>
<tr>
<td style="text-align:left;">
PriceDiff
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
-0.67
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.64
</td>
<td style="text-align:left;">
▁▂▃▇▂
</td>
</tr>
<tr>
<td style="text-align:left;">
PctDiscMM
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:left;">
▇▁▂▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
PctDiscCH
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:left;">
▇▁▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
ListPriceDiff
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:left;">
▂▃▆▇▁
</td>
</tr>
</tbody>
</table>
</div>
<ol start="2" style="list-style-type: lower-alpha">
<li>How many observations are there in the CH class and MM class</li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li>Use <code>ggplot</code> or <code>ggpairs</code> to visualise numerical variables, answering questions such as which variables may be useful in predicting the type of orange juice purchased by the customer, any outlier/extreme observations.</li>
</ol>
<div class="webex-solution">
<button>
Hint
</button>
<p>Check Lab 3 Sections 2.1 and 3.2 for examples.</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<p>Below is an example code examining <code>PriceDiff</code> and <code>ListPriceDiff</code> using density plots and boxplots.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="exercise-1-orange-juice-dataset.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="exercise-1-orange-juice-dataset.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(OJ, <span class="fu">aes</span>(<span class="at">x=</span>PriceDiff, <span class="at">colour=</span>Purchase)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="exercise-1-orange-juice-dataset.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="exercise-1-orange-juice-dataset.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(OJ, <span class="fu">aes</span>(<span class="at">x=</span>PriceDiff, <span class="at">colour=</span>Purchase)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="exercise-1-orange-juice-dataset.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="exercise-1-orange-juice-dataset.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb13-2"><a href="exercise-1-orange-juice-dataset.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(OJ, <span class="at">columns=</span><span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">17</span>), ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">colour=</span>Purchase, <span class="at">alpha=</span><span class="fl">0.2</span>))</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-9-3.png" width="672" /></p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Produce barcharts of categorical variables separated by groups.</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<p>Below is an example code examining <code>SpecialCH</code> using barchart.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="exercise-1-orange-juice-dataset.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(OJ, <span class="fu">aes</span>(<span class="at">x=</span>SpecialCH, <span class="at">fill=</span>Purchase)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="exercise-1-orange-juice-dataset.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="effect-of-different-parameters-in-svm" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Effect of different parameters in SVM<a href="exercise-1-orange-juice-dataset.html#effect-of-different-parameters-in-svm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before building a powerful SVM classifier, we illustrate the effect of different kernels and/or different parameters in SVM by working with only two numeric variables (hence we could visualise the decision boundary in 2D).</p>
<p>Suppose we select <code>PriceDiff</code> and <code>ListPriceDiff</code> as the predictor variables.</p>
<p><strong>Task</strong></p>
<ol start="4" style="list-style-type: decimal">
<li>Build a support vector classifier, i.e. SVM with a linear kernel, and visualise the decision boundary.</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="exercise-1-orange-juice-dataset.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb15-2"><a href="exercise-1-orange-juice-dataset.html#cb15-2" aria-hidden="true" tabindex="-1"></a>Model_linear <span class="ot">&lt;-</span> <span class="fu">svm</span>(Purchase<span class="sc">~</span>PriceDiff<span class="sc">+</span>ListPriceDiff, OJ, <span class="at">type=</span><span class="st">&quot;C-classification&quot;</span>, <span class="at">kernel=</span><span class="st">&quot;linear&quot;</span>)</span>
<span id="cb15-3"><a href="exercise-1-orange-juice-dataset.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Model_linear, OJ, ListPriceDiff<span class="sc">~</span>PriceDiff)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<ol start="5" style="list-style-type: decimal">
<li>Build an SVM with a polynomial kernel with two different degrees (by using the argument <code>degree</code>) and two intercept coefficients (by using the argument <code>coef</code>).</li>
</ol>
<p>The decision boundary will be <select class='webex-select'><option value='blank'></option><option value=''>less flexible</option><option value='answer'>more flexible</option></select> if the degree in the polynomial kernel is higher.</p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="exercise-1-orange-juice-dataset.html#cb16-1" aria-hidden="true" tabindex="-1"></a>Model_poly <span class="ot">&lt;-</span> <span class="fu">svm</span>(Purchase<span class="sc">~</span>PriceDiff<span class="sc">+</span>ListPriceDiff, OJ, <span class="at">type=</span><span class="st">&quot;C-classification&quot;</span>, <span class="at">kernel=</span><span class="st">&quot;polynomial&quot;</span>, <span class="at">degree=</span><span class="dv">2</span>)</span>
<span id="cb16-2"><a href="exercise-1-orange-juice-dataset.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Model_poly, OJ, ListPriceDiff<span class="sc">~</span>PriceDiff)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="exercise-1-orange-juice-dataset.html#cb17-1" aria-hidden="true" tabindex="-1"></a>Model_poly2 <span class="ot">&lt;-</span> <span class="fu">svm</span>(Purchase<span class="sc">~</span>PriceDiff<span class="sc">+</span>ListPriceDiff, OJ, <span class="at">type=</span><span class="st">&quot;C-classification&quot;</span>, <span class="at">kernel=</span><span class="st">&quot;polynomial&quot;</span>, <span class="at">degree=</span><span class="dv">4</span>)</span>
<span id="cb17-2"><a href="exercise-1-orange-juice-dataset.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Model_poly2, OJ, ListPriceDiff<span class="sc">~</span>PriceDiff)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="exercise-1-orange-juice-dataset.html#cb18-1" aria-hidden="true" tabindex="-1"></a>Model_poly3 <span class="ot">&lt;-</span> <span class="fu">svm</span>(Purchase<span class="sc">~</span>PriceDiff<span class="sc">+</span>ListPriceDiff, OJ, <span class="at">type=</span><span class="st">&quot;C-classification&quot;</span>, <span class="at">kernel=</span><span class="st">&quot;polynomial&quot;</span>, <span class="at">degree=</span><span class="dv">4</span>, <span class="at">coef=</span><span class="dv">2</span>)</span>
<span id="cb18-2"><a href="exercise-1-orange-juice-dataset.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Model_poly3, OJ, ListPriceDiff<span class="sc">~</span>PriceDiff)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-12-3.png" width="672" /></p>
</div>
<ol start="6" style="list-style-type: decimal">
<li>Now fix the degree and intercepts in the polynomial kernel and change the cost parameter for soft-margin SVM (by using the argument <code>cost</code>). Visualise the decision boundary for two different cost values.</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="exercise-1-orange-juice-dataset.html#cb19-1" aria-hidden="true" tabindex="-1"></a>Model_poly4 <span class="ot">&lt;-</span> <span class="fu">svm</span>(Purchase<span class="sc">~</span>PriceDiff<span class="sc">+</span>ListPriceDiff, OJ, <span class="at">type=</span><span class="st">&quot;C-classification&quot;</span>, <span class="at">kernel=</span><span class="st">&quot;polynomial&quot;</span>, <span class="at">degree=</span><span class="dv">5</span>, <span class="at">cost=</span><span class="fl">0.01</span>)</span>
<span id="cb19-2"><a href="exercise-1-orange-juice-dataset.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Model_poly4, OJ, ListPriceDiff<span class="sc">~</span>PriceDiff)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="exercise-1-orange-juice-dataset.html#cb20-1" aria-hidden="true" tabindex="-1"></a>Model_poly5 <span class="ot">&lt;-</span> <span class="fu">svm</span>(Purchase<span class="sc">~</span>PriceDiff<span class="sc">+</span>ListPriceDiff, OJ, <span class="at">type=</span><span class="st">&quot;C-classification&quot;</span>, <span class="at">kernel=</span><span class="st">&quot;polynomial&quot;</span>, <span class="at">degree=</span><span class="dv">5</span>, <span class="at">cost=</span><span class="dv">10</span>)</span>
<span id="cb20-2"><a href="exercise-1-orange-juice-dataset.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Model_poly5, OJ, ListPriceDiff<span class="sc">~</span>PriceDiff)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-13-2.png" width="672" /></p>
</div>
<!-- Note that in `e1071` package, SVM is formulated using the dual optimisation problem (see the supplementary material on page 6 of Week 5 note). A consequence of this is that the cost parameter in `R` takes the opposite effect to the cost parameter $C$ taught in the lecture (i.e. the penalty assigned to slack variables). In other words, a small value of cost parameter in `R` corresponds to a large value of $C$ in the lecture note, and vice versa. We can check this by comparing the classification accuracy of SVMs built with different cost parameters. Intuitively, a large $C$ (i.e. a small cost in `R`) encourages the model to better fit the data and hence improve the accuracy, and this is indeed the case as shown in the `R` command below.  -->
<!-- ```{r} -->
<!-- Model_poly3 <- svm(Purchase~PriceDiff+ListPriceDiff, OJ, type="C-classification", kernel="polynomial", degree=5, cost=0.01) -->
<!-- mean(OJ$Purchase == predict(Model_poly3,OJ)) -->
<!-- Model_poly4 <- svm(Purchase~PriceDiff+ListPriceDiff, OJ, type="C-classification", kernel="polynomial", degree=5, cost=10) -->
<!-- mean(OJ$Purchase == predict(Model_poly4,OJ)) -->
<!-- ``` -->
<ol start="7" style="list-style-type: decimal">
<li>Build an SVM with a radial basis function (RBF) kernel with two different gamma values (using the argument <code>gamma</code>) and visualise the decision boundary.</li>
</ol>
<p>The decision boundary will be <select class='webex-select'><option value='blank'></option><option value=''>less flexible</option><option value='answer'>more flexible</option></select> if gamma in the RBF kernel is larger.</p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="exercise-1-orange-juice-dataset.html#cb21-1" aria-hidden="true" tabindex="-1"></a>Model_RBF <span class="ot">&lt;-</span> <span class="fu">svm</span>(Purchase<span class="sc">~</span>PriceDiff<span class="sc">+</span>ListPriceDiff, OJ, <span class="at">type=</span><span class="st">&quot;C-classification&quot;</span>, <span class="at">kernel=</span><span class="st">&quot;radial&quot;</span>, <span class="at">gamma=</span><span class="fl">0.1</span>)</span>
<span id="cb21-2"><a href="exercise-1-orange-juice-dataset.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Model_RBF, OJ, ListPriceDiff<span class="sc">~</span>PriceDiff)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="exercise-1-orange-juice-dataset.html#cb22-1" aria-hidden="true" tabindex="-1"></a>Model_RBF2 <span class="ot">&lt;-</span> <span class="fu">svm</span>(Purchase<span class="sc">~</span>PriceDiff<span class="sc">+</span>ListPriceDiff, OJ, <span class="at">type=</span><span class="st">&quot;C-classification&quot;</span>, <span class="at">kernel=</span><span class="st">&quot;radial&quot;</span>, <span class="at">degree=</span><span class="dv">10</span>)</span>
<span id="cb22-2"><a href="exercise-1-orange-juice-dataset.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Model_RBF2, OJ, ListPriceDiff<span class="sc">~</span>PriceDiff)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-14-2.png" width="672" /></p>
</div>
</div>
<div id="build-an-svm" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Build an SVM<a href="exercise-1-orange-juice-dataset.html#build-an-svm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now we start to build an SVM. The first step is to split the data into training and test sets for training and evaluating the classifier; the validation set is skipped here as we will use the default tuning method on the training set.</p>
<p><strong>Task</strong></p>
<ol start="8" style="list-style-type: decimal">
<li>Split the dataset into 75% for training and 25% for testing.</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="exercise-1-orange-juice-dataset.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb23-2"><a href="exercise-1-orange-juice-dataset.html#cb23-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(OJ)</span>
<span id="cb23-3"><a href="exercise-1-orange-juice-dataset.html#cb23-3" aria-hidden="true" tabindex="-1"></a>train.idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(n, <span class="fu">round</span>(n<span class="sc">*</span><span class="fl">0.75</span>))</span>
<span id="cb23-4"><a href="exercise-1-orange-juice-dataset.html#cb23-4" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> OJ[train.idx,]</span>
<span id="cb23-5"><a href="exercise-1-orange-juice-dataset.html#cb23-5" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> OJ[<span class="sc">-</span>train.idx]</span></code></pre></div>
</div>
<p><br></p>
<p>SVM is scale-invariant and therefore it is important to standardise the data first; here, standardisation is only applied to numerical variables.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="exercise-1-orange-juice-dataset.html#cb24-1" aria-hidden="true" tabindex="-1"></a>numerical_vars <span class="ot">&lt;-</span> <span class="fu">sapply</span>(OJ,is.numeric) <span class="co">#identify numerical variables</span></span>
<span id="cb24-2"><a href="exercise-1-orange-juice-dataset.html#cb24-2" aria-hidden="true" tabindex="-1"></a>OJ[,numerical_vars] <span class="ot">&lt;-</span> <span class="fu">apply</span>(OJ[,numerical_vars],<span class="dv">2</span>,scale)</span></code></pre></div>
<p>Our initial exploratory analysis suggests that it is unlikely to separate the class by using a linear decision boundary. Therefore, we focus on polynomial kernel and RBF kernel for our subsequent analysis.</p>
<ol start="9" style="list-style-type: decimal">
<li>Use <code>tune</code> or <code>tune.svm</code> to select the optimal combinations of <code>cost</code> and <code>degree</code> for polynomial kernel and <code>cost</code> and <code>gamma</code> for the RBF kernel.</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="exercise-1-orange-juice-dataset.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb25-2"><a href="exercise-1-orange-juice-dataset.html#cb25-2" aria-hidden="true" tabindex="-1"></a>cost_range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>)</span>
<span id="cb25-3"><a href="exercise-1-orange-juice-dataset.html#cb25-3" aria-hidden="true" tabindex="-1"></a>degree_range <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb25-4"><a href="exercise-1-orange-juice-dataset.html#cb25-4" aria-hidden="true" tabindex="-1"></a>gamma_range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.001</span>,<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>)</span>
<span id="cb25-5"><a href="exercise-1-orange-juice-dataset.html#cb25-5" aria-hidden="true" tabindex="-1"></a>SVM_poly <span class="ot">&lt;-</span> <span class="fu">tune.svm</span>(Purchase<span class="sc">~</span>., <span class="at">data=</span>train, <span class="at">type=</span><span class="st">&quot;C-classification&quot;</span>, <span class="at">kernel=</span><span class="st">&quot;polynomial&quot;</span>, <span class="at">cost=</span>cost_range, <span class="at">degree=</span>degree_range)</span>
<span id="cb25-6"><a href="exercise-1-orange-juice-dataset.html#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SVM_poly)</span></code></pre></div>
<pre><code>## 
## Parameter tuning of &#39;svm&#39;:
## 
## - sampling method: 10-fold cross validation 
## 
## - best parameters:
##  degree cost
##       2   10
## 
## - best performance: 0.1820525 
## 
## - Detailed performance results:
##    degree  cost     error dispersion
## 1       2 1e-02 0.3926852 0.05677485
## 2       3 1e-02 0.3926852 0.05677485
## 3       4 1e-02 0.3802469 0.05323575
## 4       5 1e-02 0.3715432 0.05489188
## 5       2 1e-01 0.3578241 0.05891847
## 6       3 1e-01 0.3490586 0.05982537
## 7       4 1e-01 0.3540741 0.06120994
## 8       5 1e-01 0.3528549 0.06050438
## 9       2 1e+00 0.2168827 0.05060192
## 10      3 1e+00 0.2355864 0.04716656
## 11      4 1e+00 0.2854321 0.06236839
## 12      5 1e+00 0.3178858 0.06676980
## 13      2 1e+01 0.1820525 0.04417697
## 14      3 1e+01 0.1920525 0.03412687
## 15      4 1e+01 0.2269136 0.04978096
## 16      5 1e+01 0.2430864 0.04092613
## 17      2 1e+02 0.1907562 0.04112418
## 18      3 1e+02 0.1895988 0.03886508
## 19      4 1e+02 0.2119599 0.03426569
## 20      5 1e+02 0.2157099 0.03719672</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="exercise-1-orange-juice-dataset.html#cb27-1" aria-hidden="true" tabindex="-1"></a>SVM_RBF <span class="ot">&lt;-</span> <span class="fu">tune.svm</span>(Purchase<span class="sc">~</span>., <span class="at">data=</span>train, <span class="at">type=</span><span class="st">&quot;C-classification&quot;</span>, <span class="at">kernel=</span><span class="st">&quot;radial&quot;</span>, <span class="at">cost=</span>cost_range, <span class="at">gamma=</span>gamma_range)</span>
<span id="cb27-2"><a href="exercise-1-orange-juice-dataset.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SVM_RBF)</span></code></pre></div>
<pre><code>## 
## Parameter tuning of &#39;svm&#39;:
## 
## - sampling method: 10-fold cross validation 
## 
## - best parameters:
##  gamma cost
##  0.001   10
## 
## - best performance: 0.1745062 
## 
## - Detailed performance results:
##    gamma  cost     error dispersion
## 1  1e-03 1e-02 0.3927623 0.06349114
## 2  1e-02 1e-02 0.3927623 0.06349114
## 3  1e-01 1e-02 0.3927623 0.06349114
## 4  1e+00 1e-02 0.3927623 0.06349114
## 5  1e+01 1e-02 0.3927623 0.06349114
## 6  1e+02 1e-02 0.3927623 0.06349114
## 7  1e-03 1e-01 0.3927623 0.06349114
## 8  1e-02 1e-01 0.2044599 0.04921463
## 9  1e-01 1e-01 0.1919444 0.03952223
## 10 1e+00 1e-01 0.3529012 0.06995612
## 11 1e+01 1e-01 0.3927623 0.06349114
## 12 1e+02 1e-01 0.3927623 0.06349114
## 13 1e-03 1e+00 0.1895062 0.04389485
## 14 1e-02 1e+00 0.1820216 0.04704146
## 15 1e-01 1e+00 0.1870679 0.04500966
## 16 1e+00 1e+00 0.2331173 0.03865659
## 17 1e+01 1e+00 0.2617593 0.05374654
## 18 1e+02 1e+00 0.3155247 0.03780232
## 19 1e-03 1e+01 0.1745062 0.04930779
## 20 1e-02 1e+01 0.1882407 0.05452198
## 21 1e-01 1e+01 0.2119599 0.03810401
## 22 1e+00 1e+01 0.2355556 0.05041878
## 23 1e+01 1e+01 0.2805401 0.03810152
## 24 1e+02 1e+01 0.3167901 0.03892098
## 25 1e-03 1e+02 0.1807407 0.06071558
## 26 1e-02 1e+02 0.1920216 0.04416859
## 27 1e-01 1e+02 0.2169136 0.04579364
## 28 1e+00 1e+02 0.2542747 0.04541986
## 29 1e+01 1e+02 0.2867747 0.03358065
## 30 1e+02 1e+02 0.3167901 0.03892098</code></pre>
<p>The best optimal parameter for SVM with a polynomial kernel is using a degree of 2 and a cost parameter of 10, achieving the best performance of 0.1820525 (error rate from 10-fold cross-validation). The best optimal parameter for SVM with an RBF kernel is using gamma of 0.001 and a cost parameter of 10, achieving the best performance of 0.1745062; note that this gamma value is obtained at the minimum of the range and thus it is preferable to further reduce gamma and check if the performance can be further improved.</p>
</div>
<p><br></p>
<p>Based on the above <code>R</code> output, we see that the cross-validation error rate for SVM using the RBF kernel is slightly better than using the polynomial kernel. Therefore we will proceed with RBF kernel.</p>
<ol start="10" style="list-style-type: decimal">
<li>Build an SVM using the optimal kernel and parameters found in the above question and report the performance on test set.</li>
</ol>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="exercise-1-orange-juice-dataset.html#cb29-1" aria-hidden="true" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> SVM_RBF<span class="sc">$</span>best.parameters[<span class="dv">1</span>]</span>
<span id="cb29-2"><a href="exercise-1-orange-juice-dataset.html#cb29-2" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">&lt;-</span> SVM_RBF<span class="sc">$</span>best.parameters[<span class="dv">2</span>]</span>
<span id="cb29-3"><a href="exercise-1-orange-juice-dataset.html#cb29-3" aria-hidden="true" tabindex="-1"></a>SVM_final <span class="ot">&lt;-</span> <span class="fu">svm</span>(Purchase<span class="sc">~</span>PriceDiff<span class="sc">+</span>ListPriceDiff, OJ, <span class="at">type=</span><span class="st">&quot;C-classification&quot;</span>, <span class="at">kernel=</span><span class="st">&quot;radial&quot;</span>, <span class="at">degree=</span><span class="dv">10</span>)</span>
<span id="cb29-4"><a href="exercise-1-orange-juice-dataset.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(SVM_RBF)</span></span></code></pre></div>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["main.pdf", "main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"info": true
});
});
</script>

</body>

</html>
